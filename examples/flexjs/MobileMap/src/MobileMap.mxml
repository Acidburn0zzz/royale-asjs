<?xml version="1.0" encoding="utf-8"?>
<mjs:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
                 xmlns:js="library://ns.apache.org/flexjs/basic"
                 xmlns:mjs="library://ns.apache.org/flexjs/cordova"
                 xmlns:google="library://ns.apache.org/flexjs/google"
                 applicationComplete="onDeviceReady()">
    <js:valuesImpl>
        <js:SimpleCSSValuesImpl />
    </js:valuesImpl>
    <fx:Script>
        <![CDATA[
        	import org.apache.cordova.geolocation.Geolocation;
        	import google.maps.LatLng;
        	
            private function onDeviceReady():void {
                label.text = "The device ready, loading map...";
                
                var location:Geolocation = new Geolocation();
                location.getCurrentPosition(onSuccess, onError);
            }
            
            private function onSuccess(position:Object):void
            {
            	// Extract the latitude and longitude from the position
            	// given and covert it to GoogleMaps LatLng object so
            	// the map can be centered on it.
            	
            	var lat:Number = Number(position["coords"]["latitude"]);
            	var lng:Number = Number(position["coords"]["longitude"]);
            	
            	label.text = String(lat) + ", " + String(lng);
            	map.setCenter(new LatLng(lat, lng));
            }
            
            private function onError(error:*):void
            {
            	label.text = "Location failure";
            }
        ]]>
    </fx:Script>
    <js:initialView>
        <js:View>
        	<js:VContainer width="450" height="640">
        		<js:HContainer width="100%" height="40">
        			<js:Label text="Current Location: " width="25%" />
            		<js:Label id="label" text="" width="75%" />
            	</js:HContainer>
            	<google:Map id="map" width="100%" height="600" 
                        token="AIzaSyDkQgg2iojLCYeuW6hK7DkuAHD-SwJJhdE" />
            </js:VContainer>
        </js:View>
    </js:initialView>
</mjs:Application>
